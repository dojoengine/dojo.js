# State Management Migration Guide (v1.6+)

## Overview

Starting from v1.6, the Dojo.js state management implementations have been reorganized for better modularity and maintainability. All state management solutions are now consolidated in the `@dojoengine/state` package.

## What Changed

### Package Reorganization

- **RECS-based state**: Now available at `@dojoengine/state/recs`
- **Zustand-based state**: Moved from `@dojoengine/sdk/state` to `@dojoengine/state/zustand`
- The `@dojoengine/sdk/state` path still works via re-exports for backward compatibility

## Migration Steps

### For Zustand Users

#### Option 1: No Changes Required (Backward Compatible)

If you're currently importing from `@dojoengine/sdk/state`, your code will continue to work:

```typescript
// This still works
import { createDojoStore } from "@dojoengine/sdk/state";
```

#### Option 2: Update to New Import Path (Recommended)

For better tree-shaking and clearer dependencies, update your imports:

```typescript
// Before
import { createDojoStore, GameState, DojoStore } from "@dojoengine/sdk/state";

// After (Recommended)
import {
  createDojoStore,
  GameState,
  DojoStore,
} from "@dojoengine/state/zustand";
```

### For RECS Users

The RECS implementation remains at the same location within `@dojoengine/state`:

```typescript
// No changes needed
import { getSyncEntities, getSyncEvents } from "@dojoengine/state";

// Or explicitly import from recs subpackage
import { getSyncEntities, getSyncEvents } from "@dojoengine/state/recs";
```

## Package.json Updates

If you're using the Zustand state directly from `@dojoengine/state`, ensure your dependencies include:

```json
{
  "dependencies": {
    "@dojoengine/state": "^1.6.0",
    "zustand": "^5.0.0",
    "immer": "^10.0.0"
  }
}
```

## TypeScript Configuration

No changes to TypeScript configuration are required. The package exports include proper type definitions for both implementations.

## Examples

### Creating a Zustand Store

```typescript
import { createDojoStore } from "@dojoengine/state/zustand";
import { schema } from "./models.gen";

// Create store with your schema
const store = createDojoStore<typeof schema>();

// Use the store
const entity = store.getState().getEntity("0x123");
```

### Using RECS Sync

```typescript
import { getSyncEntities } from "@dojoengine/state/recs";
import { createClientComponents } from "./createClientComponents";

const components = createClientComponents({ contractComponents });
const subscription = await getSyncEntities(client, components, clause, orderBy);
```

## Breaking Changes

None. All existing imports continue to work via re-exports.

## Need Help?

If you encounter any issues during migration:

1. Check that you're using `@dojoengine/state` version 1.6.0 or higher
2. Ensure peer dependencies (zustand, immer) are installed if using Zustand directly
3. Report issues at <https://github.com/dojoengine/dojo.js/issues>

